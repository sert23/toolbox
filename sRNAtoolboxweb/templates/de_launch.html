{% extends "base.html" %}
{% load staticfiles %}
{% block content %}

    <div id="page-wrapper">
        <div class="row">
            <div class="col-lg-12">
                <div class="page-header">
                    <h1>sRNAde: </h1>
                    <h3>Consensus differential expression (DESeq, edgeR and NOISeq), visual cluster analysis and
                        sequencing statistics. </h3>
                </div>
            </div>


            <!-- /.col-lg-12 -->
        </div>
        <!-- /.row -->
        <div class="row">
            <div class="col-lg-9">

                <table id="jobs" class="table table-striped table-bordered table-hover dataTable no-footer"></table>

                {% include 'form_base.html' %}


            </div>


            <div class="col-lg-3">
                <div class="panel panel-info">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            Help
                        </h4>
                    </div>
                    <div class="panel-body">
                        <a href="{{ settings.SUB_SITE }}/static/webmanual.pdf" target="_blank">Link to Web Manual</a>
                        <br>
                        <a href="http://bioinfo5.ugr.es/srnatoolbox/srnade/result?id=4LOC73A18CPD9KF" target="_blank">Link
                            to Test Data Results</a>
                    </div>
                </div>

            </div>

            <div class="col-lg-3">
                <div class="panel panel-green">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            Test Data Description
                        </h4>
                    </div>
                    <div class="panel-body">
                        Exosome vs Cell fraction from a panel of human B cells.
                        <br>
                        <a href="https://doi.org/10.1016/j.celrep.2014.08.027" target="_blank">Link To
                            Publication</a>
                    </div>
                </div>

            </div>

            <div class="col-lg-3">
                <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            Test Data Parameters
                        </h4>
                    </div>
                    <div class="panel-body">
                        List of sRNAbench IDs:
                        <pre style=" white-space: nowrap; overflow-y: hidden">K56Y0CAK9O26CD6:HDG1DQUKS7SPJ31:CQOIYQ3JYXAKNN0#97NEH4N8C0KV1N6:JPNQE8YW41EM39R:C06ZT6VSLD139R8</pre>
                        <br>
                        Sample groups:
                        <pre style="white-space: nowrap; overflow-y: hidden">exosome#cell</pre>
                        Or you can use this expression matrix:
                        <br>
                        <a href="http://bioinfo5.ugr.es/srnatoolbox/media/4LOC73A18CPD9KF/output_directory/mature_sense_minExpr5_RCadj.mat" download> <i
                                class="fa fa-download fa-fw"></i>Matrix File</a>


                    </div>
                </div>

            </div>
            <!-- /.row -->
        </div>
        <!-- /#page-wrapper -->
    </div>



{% endblock %}

{% block modals %}
    {% include "Messages/de/SampleDescription.html" %}
    {% include "Messages/de/ListOfIDs.html" %}
{% endblock %}

{% block js %}
    <script src="/static/vendors/datatables.net/js/jquery.dataTables.min.js"></script>
  <script src="/static/vendors/datatables.net-bs/js/dataTables.bootstrap.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons-bs/js/buttons.bootstrap.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons/js/buttons.flash.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons/js/buttons.html5.min.js"></script>
  <script src="/static/vendors/datatables.net-buttons/js/buttons.print.min.js"></script>
  <script src="/static/vendors/datatables.net-fixedheader/js/dataTables.fixedHeader.min.js"></script>
  <script src="/static/vendors/datatables.net-keytable/js/dataTables.keyTable.min.js"></script>
  <script src="/static/vendors/datatables.net-responsive/js/dataTables.responsive.min.js"></script>
  <script src="/static/vendors/datatables.net-responsive-bs/js/responsive.bootstrap.js"></script>
  <script src="/static/vendors/datatables.net-scroller/js/dataTables.scroller.min.js"></script>
    <script src="http://cdn.datatables.net/plug-ins/1.10.12/api/processing().js"></script>
{#    <script src="{% static 'js/sRNAde_form_control.js' %}"></script>#}

    <script>
        var group_dict = {{ group_data|safe }};
        var sample_keys = {{ group_keys|safe }};
        var received_data = {{ table_data|safe }};
        var received_cols = {{ table_headers|safe }}

        $(document).ready(function() {

{#        var table = $('#jobs').DataTable( {#}
         table = $('#jobs').DataTable( {

    //        'responsive': true,
            data: received_data,
    //        processing: true,
    //        serverSide: true,
    //        deferRender: false,
            'language':{
           "loadingRecords": "&nbsp;",
          "processing": "Loading..."
        },
            columns: received_cols,
        } );

    } );

{#        const keys = Object.keys(group_dict);#}
{#         for(count = 0; count < keys.length; count++){#}
{#             key = keys[count];#}
{#             alert([key,group_dict[key]]);#}
{#            };#}

    $('#jobs').on('click', 'tr', function (group_dict) {
        group_dict = group_dict || group_dict;
        var new_data = document.getElementsByName("group_selector");
         for(count = 0; count < new_data.length; count++){
                key = new_data[count].id;
                value = new_data[count].value;
{#                alert(value);#}
                group_dict[key] = value;

            }
    });

    $('#submit-id-submit').on("click", function(e) {
        const keys = sample_keys;
        var group_list = [];
        var sample_list = [];
        for(count = 0; count < keys.length; count++){
             key = keys[count];
             sample_list.push(key);
             group_list.push(group_dict[key]);
            };
        document.getElementById("id_samples_hidden").value = sample_list.join();
        document.getElementById("id_groups_hidden").value = group_list.join();
    })


    </script>
{% endblock %}
